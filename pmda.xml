<?xml version="1.0"?>
<Container version="2">
  <!-- BASIC INFO -->
  <Name>PMDA</Name>
  <Repository>meaning/pmda:latest</Repository>
  <Registry>https://hub.docker.com/r/meaning/pmda</Registry>
  <Network>bridge</Network>
  <Shell>sh</Shell>
  <Privileged>false</Privileged>

  <Support>https://github.com/silkyclouds/PMDA/issues</Support>
  <Project>https://github.com/silkyclouds/PMDA</Project>
  <Overview>PMDA: Plex Music DeDupe Assistant – detect and clean duplicate albums in your Plex music library with optional AI assistance.</Overview>
  <Category>MediaApp:Music</Category>
  <WebUI>http://[IP]:[PORT:5005]/</WebUI>
  <Icon>https://raw.githubusercontent.com/silkyclouds/PMDA/main/static/P.png</Icon>

  <!-- ──────────── VARIABLES ──────────── -->

  <Config Name="Plex Host URL"
          Target="PLEX_HOST"
          Default="http://192.168.3.2:32400"
          Description="Base URL of your Plex server, including port (e.g. http://192.168.3.2:32400)."
          Type="Variable" Display="always" Required="true" />

  <Config Name="Plex Token"
          Target="PLEX_TOKEN"
          Default=""
          Description="X-Plex-Token for your server. Required to access the Plex API."
          Type="Variable" Display="always" Required="true" Mask="true" />

  <Config Name="Music Section ID"
          Target="SECTION_ID"
          Default=""
          Description="OPTIONAL: Comma-separated list of Plex music section IDs. Leave blank to auto-detect all music libraries."
          Type="Variable" Display="advanced" Required="false" />

  <Config Name="Default Mode (serve / cli)"
          Target="PMDA_DEFAULT_MODE"
          Default="serve"
          Description="Set to 'serve' to launch the Web UI, or 'cli' for command-line usage only."
          Type="Variable" Display="always" Required="true" />

  <Config Name="OpenAI Model"
          Target="OPENAI_MODEL"
          Default="gpt-5-nano"
          Description="LLM model used for AI-based edition selection. Optional but HIGHLY recommended!"
          Type="Variable" Display="advanced" Required="false" />

  <Config Name="OpenAI API Key"
          Target="OPENAI_API_KEY"
          Default=""
          Description="API key for OpenAI. Leave blank to disable AI assistance."
          Type="Variable" Display="always" Required="false" Mask="true" />

  <Config Name="Discord Webhook URL"
          Target="DISCORD_WEBHOOK"
          Default=""
          Description="OPTIONAL: Discord webhook to receive dedupe reports and alerts."
          Type="Variable" Display="advanced" Required="false" Mask="true" />

  <Config Name="Use MusicBrainz API"
          Target="USE_MUSICBRAINZ"
          Default="false"
          Description="Enable MusicBrainz lookups for more accurate metadata. Slower but more accurate."
          Type="Variable" Display="always" Required="false" />

  <Config Name="Cross-Library Comparison"
          Target="CROSS_LIBRARY_DEDUPE"
          Default="false"
          Description="If true, compare albums across all libraries. If false, dedupe only within each library."
          Type="Variable" Display="always" Required="false" />

  <Config Name="Skip Folders"
          Target="SKIP_FOLDERS"
          Default=""
          Description="OPTIONAL: Comma-separated list of folders to exclude from scanning (e.g. /music/Trash)."
          Type="Variable" Display="advanced" Required="false" />

  <Config Name="Log Level"
          Target="LOG_LEVEL"
          Default="INFO"
          Description="Set logging verbosity. Options: DEBUG, INFO, WARNING, ERROR."
          Type="Variable" Display="advanced" Required="false" />

  <Config Name="Scan Threads"
          Target="SCAN_THREADS"
          Default="all"
          Description="Number of parallel threads used to scan your library. Default is number of CPU cores."
          Type="Variable" Display="always" Required="false" />

  <Config Name="Crosscheck Sample Size"
          Target="CROSSCHECK_SAMPLES"
          Default="20"
          Description="Advanced: Number of sample files used to verify volume bindings at startup."
          Type="Variable" Display="advanced" Required="false" />

  <Config Name="Manual PATH_MAP override"
          Target="PATH_MAP"
          Default=""
          Description="Advanced: Optional manual override for Plex path mapping. Format: /plex:/host,/plex2:/host2"
          Type="Variable" Display="advanced" Required="false" />

  <!-- ──────────── PATHS ──────────── -->

  <Config Name="Config Directory"
          Target="/config"
          Default="/mnt/user/appdata/pmda"
          Mode="rw"
          Description="Holds PMDA config.json, state.db and cache.db."
          Type="Path" Display="always" Required="true" />

  <Config Name="Plex DB Folder"
          Target="/database"
          Default="/mnt/user/appdata/plex/Library/Application Support/Plex Media Server/Plug-in Support/Databases"
          Mode="ro"
          Description="Path to the folder containing Plex’s com.plexapp.plugins.library.db file."
          Type="Path" Display="always" Required="true" />

  <Config Name="Parent Music Folder"
          Target="/music"
          Default="/mnt/user/music/"
          Mode="rw"
          Description="Parent folder containing all your music libraries. PMDA will auto-detect subfolders."
          Type="Path" Display="always" Required="true" />

  <Config Name="Dupe Output"
          Target="/dupes"
          Default="/mnt/user/music/dupes"
          Mode="rw"
          Description="Folder where duplicate albums will be moved if configured to do so."
          Type="Path" Display="always" Required="true" />

  <!-- Plex’s database path (Advanced: do not modify) -->
  <Config Name="PLEX_DB_PATH"
          Target="PLEX_DB_PATH"
          Default="/database"
          Description="(Advanced) DO NOT CHANGE THIS. Used internally to locate Plex's database."
          Type="Variable" Display="hidden" Required="true" />

  <!-- PMDA internal config path -->
  <Config Name="PMDA_CONFIG_DIR"
          Target="PMDA_CONFIG_DIR"
          Default="/config"
          Description="(Advanced) DO NOT CHANGE THIS. Used internally to store configuration and scan state."
          Type="Variable" Display="hidden" Required="true" />

  <!-- ──────────── PORTS ──────────── -->

  <Config Name="WebUI Port"
          Target="5005"
          Default="5005"
          Mode="tcp"
          Description="Container Web UI port. Accessible via http://[IP]:[PORT]/"
          Type="Port" Display="always" Required="true" />
</Container>
