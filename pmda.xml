<?xml version="1.0" encoding="utf-8"?>
<Container version="2">
  <!-- --------- Metadata --------- -->
  <Name>PMDA</Name>
  <Repository>meaning/pmda:latest</Repository>
  <Network>bridge</Network>
  <Shell>/bin/sh</Shell>
  <Privileged>false</Privileged>
  <Support>https://github.com/silkyclouds/PMDA/issues</Support>
  <Project>https://github.com/silkyclouds/PMDA</Project>
  <Overview>PMDA: Plex Music DeDupe Assistant â€“ detect and clean duplicate albums in your Plex music library with optional AI assistance.</Overview>
  <Category>MediaApp:Music Status:Beta</Category>
  <WebUI>http://[IP]:[PORT:5005]</WebUI>
  <Icon>https://raw.githubusercontent.com/silkyclouds/PMDA/main/static/P.png</Icon>

  <!-- --------- Required Variables --------- -->
  <Config Name="PLEX_HOST"   Target="PLEX_HOST"   Default="http://192.168.3.2:32400"
          Mode="env" Type="Variable" Display="always" Required="true" />
  <Config Name="PLEX_TOKEN"  Target="PLEX_TOKEN"  Default=""
          Mode="env" Type="Variable" Display="always" Required="true" Mask="true" />
  <Config Name="SECTION_ID"  Target="SECTION_ID"  Default="1"
          Mode="env" Type="Variable" Display="always" Required="true" />
  <Config Name="PLEX_DB_PATH" Target="PLEX_DB_PATH" Default="/database"
          Mode="env" Type="Variable" Display="always" Required="true" />
  <Config Name="PLEX_DB_FILE" Target="PLEX_DB_FILE" Default="com.plexapp.plugins.library.db"
          Mode="env" Type="Variable" Display="always" Required="true" />
  <Config Name="DUPE_ROOT"   Target="DUPE_ROOT"   Default="/dupes"
          Mode="env" Type="Variable" Display="always" Required="true" />

  <!-- --------- PATH_MAP : multi-line friendly --------- -->
  <!-- Edit this JSON and add/remove any mapping you need -->
  <Config Name="PATH_MAP" Target="PATH_MAP"
          Default="{\"/music/matched\":\"/path/to/music/matched\", \"./add_more_here\":\"/path/on/host\"}"
          TextArea="true"
          Mode="env" Type="Variable" Display="always" Required="true" />

  <!-- --------- Optional Behaviour / Logging --------- -->
  <Config Name="PMDA_DEFAULT_MODE" Target="PMDA_DEFAULT_MODE" Default="serve"
          Mode="env" Type="Variable" Display="advanced" />
  <Config Name="DISABLE_WEBUI"     Target="DISABLE_WEBUI"     Default="false"
          Mode="env" Type="Variable" Display="advanced" />
  <Config Name="LOG_LEVEL"         Target="LOG_LEVEL"         Default="INFO"
          Mode="env" Type="Variable" Display="advanced" />
  <Config Name="SCAN_THREADS"      Target="SCAN_THREADS"      Default="8"
          Mode="env" Type="Variable" Display="advanced" />

  <!-- --------- AI Settings --------- -->
  <Config Name="OPENAI_MODEL"      Target="OPENAI_MODEL"      Default="gpt-4o-nano"
          Mode="env" Type="Variable" Display="advanced" />
  <Config Name="OPENAI_API_KEY"    Target="OPENAI_API_KEY"    Default=""
          Mode="env" Type="Variable" Display="advanced" Mask="true" />
  <Config Name="FORMAT_PREFERENCE" Target="FORMAT_PREFERENCE" Default="flac|m4a|mp3"
          Mode="env" Type="Variable" Display="advanced" />

  <!-- --------- State files --------- -->
  <Config Name="STATE_DB_FILE"     Target="STATE_DB_FILE"     Default="./state.db"
          Mode="env" Type="Variable" Display="advanced" />
  <Config Name="CACHE_DB_FILE"     Target="CACHE_DB_FILE"     Default="./cache.db"
          Mode="env" Type="Variable" Display="advanced" />

  <!-- --------- Volumes (generic host paths) --------- -->
  <Config Name="Config Directory"        Target="/app/config"
          Default="/path/to/appdata/pmda"
          Mode="rw" Type="Path" Display="always" Required="true" />
  <Config Name="Plex DB Volume"          Target="/database"
          Default="/path/to/plex/Plug-in Support/Databases"
          Mode="ro" Type="Path" Display="always" Required="true" />
  <Config Name="Music Matched Volume"    Target="/music/matched"
          Default="/path/to/music/matched"
          Mode="rw" Type="Path" Display="always" Required="true" />
  <Config Name="Music Unmatched Volume"  Target="/music/unmatched"
          Default="/path/to/music/unmatched"
          Mode="rw" Type="Path" Display="advanced" />
  <Config Name="Music Compilations Vol." Target="/music/compilations"
          Default="/path/to/music/compilations"
          Mode="rw" Type="Path" Display="advanced" />
  <Config Name="Dupe Output Volume"      Target="/dupes"
          Default="/path/to/music/dupes"
          Mode="rw" Type="Path" Display="always" Required="true" />

  <!-- --------- Ports --------- -->
  <Port>
    <HostPort>5005</HostPort>
    <ContainerPort>5005</ContainerPort>
    <Protocol>tcp</Protocol>
  </Port>
</Container>
